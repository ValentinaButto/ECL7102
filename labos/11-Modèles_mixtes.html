<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Modèles mixtes</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Modèles mixtes</h1>
<h4 class="date"><em>21 novembre 2018</em></h4>

</div>


<div id="effet-de-lazote-sur-le-rendement-de-varietes-davoine" class="section level2">
<h2>1. Effet de l’azote sur le rendement de variétés d’avoine</h2>
<p>Le tableau de données <code>Oats</code> inclus dans le package <em>nlme</em> présente les résultats d’une expérience agricole en parcelles divisées (<em>split-plot</em>). L’expérience est réalisée en six blocs (<code>Block</code>). Chaque bloc est divisé en trois sections où une variété différente d’avoine est semée (<code>Variety</code>), puis chaque section est divisée en quatre quadrants qui reçoivent chacun une concentration différente d’azote (<code>nitro</code>): 0, 0.2, 0.4 ou 0.6. La variable réponse est le rendement (<code>yield</code>) en avoine pour chacun des 72 quadrants (6 blocs x 3 variétés x 4 concentrations d’azote).</p>
<pre class="r"><code>library(nlme)
data(Oats)
# Changer le bloc en facteur non-ordonné
Oats$Block &lt;- factor(Oats$Block, ordered = FALSE)
str(Oats)</code></pre>
<pre><code>## Classes &#39;nfnGroupedData&#39;, &#39;nfGroupedData&#39;, &#39;groupedData&#39; and &#39;data.frame&#39;:   72 obs. of  4 variables:
##  $ Block  : Factor w/ 6 levels &quot;VI&quot;,&quot;V&quot;,&quot;III&quot;,..: 6 6 6 6 6 6 6 6 6 6 ...
##  $ Variety: Factor w/ 3 levels &quot;Golden Rain&quot;,..: 3 3 3 3 1 1 1 1 2 2 ...
##  $ nitro  : num  0 0.2 0.4 0.6 0 0.2 0.4 0.6 0 0.2 ...
##  $ yield  : num  111 130 157 174 117 114 161 141 105 140 ...
##  - attr(*, &quot;formula&quot;)=Class &#39;formula&#39;  language yield ~ nitro | Block
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##  - attr(*, &quot;labels&quot;)=List of 2
##   ..$ y: chr &quot;Yield&quot;
##   ..$ x: chr &quot;Nitrogen concentration&quot;
##  - attr(*, &quot;units&quot;)=List of 2
##   ..$ y: chr &quot;(bushels/acre)&quot;
##   ..$ x: chr &quot;(cwt/acre)&quot;
##  - attr(*, &quot;inner&quot;)=Class &#39;formula&#39;  language ~Variety
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt;</code></pre>
<ol style="list-style-type: lower-alpha">
<li><p>Pour les facteurs <code>Block</code> et <code>Variety</code>, quel type de contrastes devriez-vous utiliser pour comparer l’effet de chaque catégorie à la moyenne, plutôt qu’à une catégorie de référence? Spécifiez ce type de contrastes et nommez les variables de contraste pour en faciliter l’interprétation.</p></li>
<li><p>Estimez les paramètres d’un modèle linéaire du rendement en fonction de la concentration d’azote, de la variété d’avoine et d’un effet <em>fixe</em> du bloc. Vérifiez s’il est utile d’inclure l’interaction entre l’azote et la variété. Que signifierait une telle interaction?</p></li>
<li><p>Choisissez le modèle avec ou sans interaction selon votre résultat en (b), vérifiez les graphiques de diagnostic et interprétez la valeur des coefficients.</p></li>
<li><p>Estimez maintenant les paramètres d’un modèle mixte identique au modèle linéaire en (c), excepté que l’effet des blocs est aléatoire plutôt que fixe. Comparez les effets fixes communs aux deux modèles, ainsi que les effets fixes de bloc du modèle précédent aux effets aléatoires par bloc de ce nouveau modèle. Expliquez les différences que vous observez, s’il y a lieu.</p></li>
<li><p>Calculez la corrélation intra-classe pour le modèle mixte en (d). Quelle est la signification mathématique de ce coefficient? Comment interprétez-vous de résultat d’un point de vue biologique?</p></li>
</ol>
</div>
<div id="indicateurs-dune-maladie-chez-les-abeilles" class="section level2">
<h2>2. Indicateurs d’une maladie chez les abeilles</h2>
<p>La loque américaine est une maladie infectieuse affectant les colonies d’abeille. Le tableau de données <a href="bees.csv" class="uri">bees.csv</a>, tiré du manuel de Zuur et al. <em>Mixed Effects Models and Extensions in Ecology with R</em>, contient des mesures de la densité de spores bactériennes (<code>Spobee</code>) relevée sur 72 abeilles provenant de 24 ruches (<code>Hive</code>, 3 abeilles par ruche).</p>
<p>Nous voulons déterminer la relation entre cette densité de spores et deux variables définies par ruche: le niveau d’infection observé dans la ruche (<code>Infection</code>) et un estimé de la taille de la colonie (<code>BeesN</code>).</p>
<pre class="r"><code>bees &lt;- read.csv(&quot;bees.csv&quot;)
str(bees)</code></pre>
<pre><code>## &#39;data.frame&#39;:    72 obs. of  7 variables:
##  $ Rawdata  : num  2 4 2 2 6 0 6 2 5 10 ...
##  $ Spobee   : num  6.67 13.33 6.67 6.67 20 ...
##  $ Hive     : int  1 1 1 2 2 2 3 3 3 4 ...
##  $ X        : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Y        : num  0 0 0 91 91 91 262 262 262 353 ...
##  $ Infection: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ BeesN    : int  95000 95000 95000 95000 95000 95000 85000 85000 85000 90000 ...</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Avant de modéliser ces données, effectuez les transformations suivantes.</li>
</ol>
<ul>
<li><p>Le niveau d’infection est sur une échelle qualitative (0 = pas de symptômes, 1 = infection légere, 2 = modérée et 3 = sévère). Puisque nous avons très peu de ruches pour les différents niveaux d’infection (1 de niveau 1, 1 de niveau 2 et 2 de niveau 3), créez une nouvelle variable binaire <code>pres_inf</code> qui indique la présence (niveaux 1 à 3) ou l’absence (niveau 0) d’infection.</p></li>
<li><p>La distribution de la réponse <code>Spobee</code> est très asymétrique. Tel que suggéré par Zuur et al., créez une nouvelle variable en appliquant la fonction <code>log1p</code>, équivalente à <em>log(Spobee + 1)</em>. Il s’agit d’une transformation logarithmique où on a préalabement ajouté 1 à la réponse, afin d’éviter de prendre le logarithme de 0.</p></li>
<li><p>Exprimez la taille de la colonie en unités de 10 000 abeilles.</p></li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Estimez les paramètres d’un modèle mixte pour déterminer l’effet de la présence d’infection et de la taille de la colonie sur la densité de spores (transformée) observée sur les abeilles. Quel effet aléatoire serait approprié pour ce problème?</p></li>
<li><p>Utilisez des graphiques de diagnostic pour vérifier les suppositions du modèle, incluant la normalité des effets aléatoires.</p></li>
<li><p>Quel est le coefficient de corrélation intra-classe de ce modèle? Pour estimer plus précisément les effets fixes de ce modèle, serait-il préférable d’échantillonner plus de ruches, ou plus d’abeilles par ruche?</p></li>
<li><p>Quels sont les intervalles de confiance à 95% des effets fixes dans le modèle mixte? Si on remplaçait ce modèle par une régression linéaire ignorant complètement la variable <code>Hive</code>, ces intervalles seraient-ils plus étroits ou plus larges, et pourquoi?</p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
