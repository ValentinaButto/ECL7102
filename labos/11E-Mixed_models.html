<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="date" content="2018-11-21" />

<title>Mixed models</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Mixed models</h1>
<h4 class="date"><em>November 21, 2018</em></h4>

</div>


<div id="effect-of-nitrogen-on-the-yield-of-oat-varieties" class="section level2">
<h2>1. Effect of nitrogen on the yield of oat varieties</h2>
<p>The <code>Oats</code> data frame included in the <em>nlme</em> package shows the results of a split-plot agricultural experiment. The experiment is done in six blocks (<code>Block</code>). Each block is divided into three sections where a different variety of oats is sown (<code>Variety</code>), then each section is divided into four quadrants, each receiving a different concentration of nitrogen (<code>nitro</code>): 0, 0.2, 0.4 or 0.6. The response variable is the oat yield of each of the 72 quadrants (6 blocks x 3 varieties x 4 nitrogen concentrations).</p>
<pre class="r"><code>library(nlme)
data(Oats)
# Changer le bloc en facteur non-ordonn√©
Oats$Block &lt;- factor(Oats$Block, ordered = FALSE)
str(Oats)</code></pre>
<pre><code>## Classes &#39;nfnGroupedData&#39;, &#39;nfGroupedData&#39;, &#39;groupedData&#39; and &#39;data.frame&#39;:   72 obs. of  4 variables:
##  $ Block  : Factor w/ 6 levels &quot;VI&quot;,&quot;V&quot;,&quot;III&quot;,..: 6 6 6 6 6 6 6 6 6 6 ...
##  $ Variety: Factor w/ 3 levels &quot;Golden Rain&quot;,..: 3 3 3 3 1 1 1 1 2 2 ...
##  $ nitro  : num  0 0.2 0.4 0.6 0 0.2 0.4 0.6 0 0.2 ...
##  $ yield  : num  111 130 157 174 117 114 161 141 105 140 ...
##  - attr(*, &quot;formula&quot;)=Class &#39;formula&#39;  language yield ~ nitro | Block
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##  - attr(*, &quot;labels&quot;)=List of 2
##   ..$ y: chr &quot;Yield&quot;
##   ..$ x: chr &quot;Nitrogen concentration&quot;
##  - attr(*, &quot;units&quot;)=List of 2
##   ..$ y: chr &quot;(bushels/acre)&quot;
##   ..$ x: chr &quot;(cwt/acre)&quot;
##  - attr(*, &quot;inner&quot;)=Class &#39;formula&#39;  language ~Variety
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt;</code></pre>
<ol style="list-style-type: lower-alpha">
<li><p>For the <code>Block</code> and<code>Variety</code> factors, which kind of contrasts should you use to compare the effect of each category to the mean, rather than to a reference category? Specify this type of contrast and name the contrast variables to facilitate the interpretation.</p></li>
<li><p>Estimate the parameters of a linear model of yield as a function of nitrogen concentration, oat variety and a <em>fixed</em> effect of the block. Check if it is useful to include the interaction between nitrogen and variety. What would such an interaction mean?</p></li>
<li><p>Choose the model with or without interaction according to your result in (b), check the diagnostic graphs and interpret the value of the coefficients.</p></li>
<li><p>Now estimate the parameters of a mixed model identical to the linear model in (c), except that the effect of the blocks is random rather than fixed. Compare the fixed effects common to both models, as well as the block fixed effects of the previous model to the random effects of this new model. Explain the differences you observe, if any.</p></li>
<li><p>Calculate the intra-class correlation for the mixed model in (d). What is the mathematical significance of this coefficient? How do you interpret the result from a biological point of view?</p></li>
</ol>
</div>
<div id="indicators-of-disease-in-bees" class="section level2">
<h2>2. Indicators of disease in bees</h2>
<p>American foulbrood is an infectious disease affecting bee colonies. The <a href="bees.csv" class="uri">bees.csv</a> dataset, from the Zuur et al. textbook <em>Mixed Effects Models and Extensions in Ecology with R</em>, contains measurements of bacterial spore density (<code>Spobee</code>) found on 72 bees from 24 hives (<code>Hive</code>, 3 bees per hive).</p>
<p>We want to determine the relationship between this density of spores and two variables defined for each hive: the level of infection observed in the hive (<code>Infection</code>) and an estimate of the size of the colony (<code>BeesN</code>).</p>
<pre class="r"><code>bees &lt;- read.csv(&quot;bees.csv&quot;)
str(bees)</code></pre>
<pre><code>## &#39;data.frame&#39;:    72 obs. of  7 variables:
##  $ Rawdata  : num  2 4 2 2 6 0 6 2 5 10 ...
##  $ Spobee   : num  6.67 13.33 6.67 6.67 20 ...
##  $ Hive     : int  1 1 1 2 2 2 3 3 3 4 ...
##  $ X        : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Y        : num  0 0 0 91 91 91 262 262 262 353 ...
##  $ Infection: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ BeesN    : int  95000 95000 95000 95000 95000 95000 85000 85000 85000 90000 ...</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Before modeling these data, perform the following transformations.</li>
</ol>
<ul>
<li><p>The level of infection is on a qualitative scale (0 = no symptoms, 1 = mild infection, 2 = moderate and 3 = severe). Since we have very few hives for the different levels of infection (1 level 1, 1 level 2, and 2 level 3), create a new <code>pres_inf</code> binary variable that indicates presence (levels 1 to 3) or absence (level 0) of infection.</p></li>
<li><p>The distribution of the <code>Spobee</code> response is very asymmetrical. As suggested by Zuur et al., create a new variable by applying the <code>log1p</code> function, equivalent to <em>log(Spobee + 1)</em>. This is a logarithmic transformation where 1 has been added to the response beforehand to avoid taking the logarithm of 0.</p></li>
<li><p>Express the size of the colony in units of 10,000 bees.</p></li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Estimate the parameters of a mixed model to determine the effect of presence of infection and colony size on the (transformed) spore density observed on bees. Which random effect would be appropriate for this problem?</p></li>
<li><p>Use diagnostic graphs to verify model assumptions, including the normality of random effects.</p></li>
<li><p>What is the intra-class correlation coefficient of this model? To more accurately estimate the fixed effects of this model, would it be better to sample more hives, or more bees per hive?</p></li>
<li><p>What are the 95% confidence intervals for fixed effects in the mixed model? If we replace this model with a linear regression completely ignoring the <code>Hive</code> variable, would these intervals be narrower or wider, and why?</p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
