<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Analyses multivariées, Partie 1</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
    <script src="libs/plotly-binding-4.8.0/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <script src="libs/jquery-1.11.3/jquery.min.js"></script>
    <link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="styles-xar.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Analyses multivariées, Partie 1
### <br/>2 décembre 2019

---




&lt;style type="text/css"&gt;
.small { font-size: 70% }
&lt;/style&gt;

# Objectifs

- Décrire différents rôles des techniques d'analyse multivariées.

- Décrire l'utilité des méthodes d'ordination et de regroupement pour réduire la dimensionalité d'un jeu de données.

- Exécuter une analyse en composantes principales et pouvoir interpréter les résultats.

- Diviser les observations en classes à partir des méthodes de regroupement hiérarchique.

---

# Pourquoi les analyses multivariées?

Les analyses multivariées servent à modéliser la *distribution conjointe* de plusieurs variables (distribution des variables individuelles et corrélations). Par exemple:

--

- visualiser les similitudes entre sites d'observation en fonction de plusieurs variables mesurées pour chaque site;

--

- expliquer une réponse multivariée;

--
    
- expliquer une réponse univariée en fonction d'un grand nombre de prédicteurs partiellement corrélés.
    
---

# Structure des données multivariées

Matrice `\(X\)` représentant `\(n\)` observations de `\(p\)` variables.

$$  
`\begin{bmatrix}
x_{11} &amp; x_{12} &amp; ... &amp; x_{1p} \\
x_{21} &amp; x_{22} &amp; ... &amp; x_{2p} \\
... &amp; ... &amp; ... &amp; ... \\
x_{n1} &amp; ... &amp; ... &amp; x_{np}
\end{bmatrix}`
$$

---

# Exemple

Données climatiques pour 49 grandes villes (source: WorldClim).

.small[


```r
villes &lt;- read.csv("../donnees/cities_climate.csv")
head(villes)
```

```
##       city    long    lat t_mean t_diu  t_sd t_max t_min p_ann p_max p_min
## 1    Tokyo 139.751 35.685   15.6   7.9 7.492  30.7   0.7  1428   185    47
## 2 Shanghai 121.400 31.046   16.2   7.4 8.339  31.6   0.8  1050   167    41
## 3   Mumbai  72.826 18.975   26.8   7.3 1.767  32.7  18.9  2370   827     0
## 4  Karachi  67.082 24.906   25.9   9.9 4.035  34.2  12.0   194    82     0
## 5    Delhi  77.217 28.667   25.1  13.1 6.715  40.5   7.3   734   274     3
## 6   Manila 120.982 14.604   27.3   8.0 1.078  33.8  21.4  2150   466     8
##   p_cv
## 1   40
## 2   46
## 3  143
## 4  134
## 5  142
## 6   90
```

]

---

# Normalisation des données

- Les méthodes d'ordination et de regroupement sont basées sur le concept de *distance* entre les points dans l'espace à `\(p\)` dimensions. 

--

- On ne peut pas comparer cette distance selon plusieurs variables avec des unités différentes.

--

- C'est pourquoi on commence par normaliser les variables: soustraire de chaque colonne sa moyenne et diviser par son écart-type (fonction `scale` dans R). Le résultat est une matrice où chaque colonne a une moyenne de 0 et un écart-type de 1. 

---

# Réduction de la dimensionnalité

- Comme on ne peut pas visualiser un nuage de points en 9 dimensions, il serait utile de réduire la dimensionnalité des données tout en conservant le maximum d'information sur la variation entre les villes.

--

- Les méthodes d'**ordination** effectuent une transformation des `\(p\)` variables originales en un nombre plus restreint de nouvelles variables, en reproduisant le plus fidèlement possible les distances entre les points dans l'espace original en `\(p\)` dimensions. Ex.: analyse en composantes principales.

--

- Les méthodes de **regroupement** (*clustering*) divisent les observations en un nombre discret de groupes (ou catégories) en fonction de leur proximité dans l'espace à `\(p\)` dimensions. Ex.: classification hiérarchique ascendante.

---

class: inverse, middle

# Analyse en composantes principales (ACP)

---

# Introduction

Nuage de points de 3 variables climatiques pour les 49 villes:

<div id="htmlwidget-994b0c30d7208572d718" style="width:576px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-994b0c30d7208572d718">{"x":{"visdat":{"23f85c2c4103":["function () ","plotlyVisDat"]},"cur_data":"23f85c2c4103","attrs":{"23f85c2c4103":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":1,"inherit":true},"23f85c2c4103.1":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"text":{},"type":"scatter3d","mode":"text","size":0.5,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"t_mean"},"yaxis":{"title":"t_sd"},"zaxis":{"title":"p_ann"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[15.6,16.2,26.8,25.9,25.1,27.3,4.9,10.9,18.2,14,27,15.8,27.5,12,25.6,21.4,18.8,12.1,11,11.4,25.9,24,23.1,22.7,28,14.7,7.9,27.3,17.6,4.9,18.3,14.8,26.7,17.7,26.8,25.4,27.4,16.6,9,6.5,14.1,12.1,24.4,15.2,18.4,24.7,15.7,25.7,11.3],"y":[7.492,8.339,1.767,4.035,6.715,1.078,9.803,10.167,2.137,6.292,1.09,2.039,0.43,8.775,1.333,5.242,2.659,10.686,4.943,0.324,3.667,7.331,1.969,8.704,1.329,4.373,9.543,1.485,3.668,8.937,3.509,3.768,1.055,3.705,0.446,7.128,0.999,2.941,6.918,10.737,6.672,8.676,2.336,1.139,1.205,2.499,5.805,1.086,5.687],"z":[1428,1050,2370,194,734,2150,679,1420,1388,759,1672,641,1949,1150,1370,20,15,608,627,994,1979,608,1255,159,1457,355,793,2465,1275,636,394,656,1790,411,2363,111,1822,885,574,965,437,330,440,1156,935,461,788,1506,633],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","size":[100],"sizemode":"area","line":{"color":"rgba(31,119,180,1)"}},"textfont":{"size":100},"error_y":{"color":"rgba(31,119,180,1)","width":100},"error_x":{"color":"rgba(31,119,180,1)","width":100},"line":{"color":"rgba(31,119,180,1)","width":100},"frame":null},{"x":[15.6,16.2,26.8,25.9,25.1,27.3,4.9,10.9,18.2,14,27,15.8,27.5,12,25.6,21.4,18.8,12.1,11,11.4,25.9,24,23.1,22.7,28,14.7,7.9,27.3,17.6,4.9,18.3,14.8,26.7,17.7,26.8,25.4,27.4,16.6,9,6.5,14.1,12.1,24.4,15.2,18.4,24.7,15.7,25.7,11.3],"y":[7.492,8.339,1.767,4.035,6.715,1.078,9.803,10.167,2.137,6.292,1.09,2.039,0.43,8.775,1.333,5.242,2.659,10.686,4.943,0.324,3.667,7.331,1.969,8.704,1.329,4.373,9.543,1.485,3.668,8.937,3.509,3.768,1.055,3.705,0.446,7.128,0.999,2.941,6.918,10.737,6.672,8.676,2.336,1.139,1.205,2.499,5.805,1.086,5.687],"z":[1428,1050,2370,194,734,2150,679,1420,1388,759,1672,641,1949,1150,1370,20,15,608,627,994,1979,608,1255,159,1457,355,793,2465,1275,636,394,656,1790,411,2363,111,1822,885,574,965,437,330,440,1156,935,461,788,1506,633],"text":["Tokyo","Shanghai","Mumbai","Karachi","Delhi","Manila","Moscow","Seoul","Sao Paulo","Istanbul","Lagos","Mexico","Jakarta","New York","Kinshasa","Cairo","Lima","Beijing","London","Bogota","Dhaka","Lahore","Rio de Janeiro","Baghdad","Bangkok","Santiago","Toronto","Rangoon","Sydney","Saint Petersburg","Los Angeles","Melbourne","Abidjan","Casablanca","Singapore","Riyadh","Ho Chi Minh City","Cape Town","Berlin","Montreal","Madrid","Kabul","Luanda","Addis Abeba","Nairobi","Dakar","Rome","Santo Domingo","Paris"],"type":"scatter3d","mode":"text","marker":{"color":"rgba(255,127,14,1)","size":[10],"sizemode":"area","line":{"color":"rgba(255,127,14,1)"}},"textfont":{"size":10},"error_y":{"color":"rgba(255,127,14,1)","width":10},"error_x":{"color":"rgba(255,127,14,1)","width":10},"line":{"color":"rgba(255,127,14,1)","width":10},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>

---

# Introduction

Considérons le cas extrême où une des trois variables est parfaitement prédite par les deux autres (collinéarité parfaite), par exemple `\(z = 2x - 5y\)`.

<div id="htmlwidget-bcca877ce068f8f9386a" style="width:576px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-bcca877ce068f8f9386a">{"x":{"visdat":{"23f8271a2637":["function () ","plotlyVisDat"]},"cur_data":"23f8271a2637","attrs":{"23f8271a2637":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":1,"inherit":true},"23f8271a2637.1":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"mesh3d","opacity":0.3,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[-0.271587810661127,0.392192372148248,-0.0701496159177563,-1.65549736240213,0.0866980662935922,0.0268015244547493,-0.756350691230064,0.327676500990502,0.686491468460999,-0.508517331496155,-2.18063643038127,-0.437402169683251,-1.1396804012721,1.40621950043755,0.681189339215317,-0.821956605066231,-0.344865158445458,0.930754228148056,0.476203866314539,1.59947574076475,-0.160764864969718,0.373514619677727,-0.485536614556292,-1.15882076635603,0.659528834352383,-1.84545505772402,1.69719354315927,-0.973376250676385,-0.816970711838642,-0.196552239944426,0.884929935545338,-0.838638259776271,-0.139345767024431,1.18417216009946,1.52300523059503,1.99386537237155,-0.710713114626022,0.685701546705991,0.39016302469895,0.403288264313363,0.111830983924876,-0.55227193377019,1.52013377493961,1.3920782583541,1.15592708374185,-0.515644621892054,1.29997912427624,-1.05975544308826,1.56693296940303,-0.754411886931618,0.713857325007896,1.60847672755908,-0.305086079990094,0.82040543937127,-2.0235191356017,-0.663953454898117,0.0709636290426882,0.00848481304508166,0.52773649014865,-3.09854127485718,1.69212974064091,0.0371489716992919,-0.482159005575903,0.3832281734916,-0.370585849338308,-0.676800386846613,0.163843690275304,0.699276086832982,-1.65279427512384,0.461933214514168,-0.342616330160529,0.286262805652797,0.268950869339603,0.0308191241864684,0.597314274265292,0.166259974597976,0.425253553060923,-1.56129616098888,-0.337130911644705,0.000111881197584884,0.33240472250862,-0.218762800819389,0.778611230629806,0.676102779493034,0.675769962140239,-1.69247961538693,-0.0234289903836234,0.702739246326102,0.268816628462489,-0.625291534792762,0.653719661822369,0.387071734324719,-0.728555289709032,0.992954900294477,-1.80663396248957,0.184917728479664,0.33347173251769,-0.504445217750995,-2.05010777766507,-1.63974651833517],"y":[0.6383599893899,2.60837969309348,-1.73410713393371,0.79647688945519,0.835518345136323,-1.01476623925331,0.829105262583481,-0.636531167463544,0.562889208109096,-0.353974231750937,-1.65256070743232,-1.44741075080028,0.19632210085371,1.62691951933712,-0.704777144731743,0.0830398464104174,0.0107759495583198,1.49765943539497,0.307882000654262,0.954150953030532,1.37360413513724,0.32406400572121,0.827632669977233,0.91513433417441,-0.269732300634022,1.28727788445067,-0.131238310055357,-1.26318619435349,0.260718488949208,-0.404475102266581,1.42780906300414,-1.30919343249675,-0.445910091463783,-1.03109100424914,1.60204991005596,-2.25283055851512,-1.29873091698353,0.591167627503003,-0.725385522353922,0.629743094073801,-0.855825008540006,1.03425078418348,0.201010638072139,-0.580619909433653,1.52838193918981,-0.892055850780181,-0.0809428841033086,0.868251034630829,0.298084997522355,1.11113153154468,0.549356599019859,0.307546929847733,3.22099073306569,-1.12789156505879,0.458972393521946,-1.87933792955786,2.49888699881599,-1.19863322568705,0.745557404604009,0.261159691735355,1.91411909412035,1.19230112446245,0.181516004762164,-0.945446008689261,1.11731419970236,-0.381073275503367,-1.82022086845281,1.38837591443655,0.976286314968764,-0.725518297573785,1.26102827239444,-0.906150700670174,-0.216471055803369,-0.265398745344153,0.0489975975595315,0.87408696657187,1.14186713087252,0.605964208037503,0.408946301807866,1.96445376745744,0.326790689872203,-0.31102611624452,0.667251868984243,-1.14446927611478,-0.7221611386795,-0.232599977843826,0.082991082318552,1.84123639603891,-1.26908041337854,-1.77578604811677,-0.657545583429841,0.480205478491412,-0.13270777868407,0.135985694782299,0.934547099054782,0.86833113725649,-1.15242022956437,-0.440514178595506,-0.434033801020963,-1.11855821219401],"z":[-3.73497556827175,-12.2575137211709,8.53023643783302,-7.29337917208022,-4.00419559309443,5.12743424517605,-5.65822769537754,3.83800883929872,-1.44146310362348,0.752836495762377,3.90153067639905,6.36224941463492,-3.26097130681275,-5.3221585958105,4.88626440208935,-2.05911244218455,-0.743610064682514,-5.62678872067872,-0.587002270642231,-1.57180328362317,-7.18955040562566,-0.873290789250598,-5.10923657899875,-6.89331320358411,2.66771917187487,-10.1272995377014,4.05057863659532,4.36917847041466,-2.93753386842332,1.62927103144405,-5.36918544393005,4.8686906429312,1.95085892327005,7.52379934144463,-4.96423908908972,15.2518835373187,5.0722283556656,-1.58443504410303,4.40725366116751,-2.34213894174228,4.50278701054978,-6.27579778845779,2.03521435951852,5.68725606387646,-5.33005552846535,3.4289900101168,3.00467266906903,-6.46076605933066,1.64344095119429,-7.06448143158661,-1.3190683450835,1.6792188058795,-16.7151258253086,7.28026870403647,-6.34190023881314,8.06878273799306,-12.3525077359946,6.01013575452543,-2.67231404272274,-7.50288100839114,-6.18633598931994,-5.88720767891367,-1.87189803496263,5.4936863904295,-6.32774269718844,0.551765603823609,9.42879172281465,-5.5433273985168,-8.18702012509149,4.55145791689726,-6.99037402229326,5.10327911465646,1.62025701769605,1.3886319750937,0.949640560732927,-4.0379148836634,-4.85882854824076,-6.15241336216528,-2.71899333232874,-9.82204507489201,-0.969144004343777,1.11760497958382,-1.77903688366161,7.07455193955997,4.96234561767798,-2.22195934155472,-0.461813392360007,-7.80070348754236,6.88303532381768,7.62834717099834,4.59516724079394,-1.62688392380762,-0.793571685997712,1.30598132667746,-8.28600342025305,-3.97182022932313,6.42904461285721,1.19368045747554,-1.93004655022532,2.3132980242997],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","size":[55],"sizemode":"area","line":{"color":"rgba(31,119,180,1)"}},"textfont":{"size":55},"error_y":{"color":"rgba(31,119,180,1)","width":55},"error_x":{"color":"rgba(31,119,180,1)","width":55},"line":{"color":"rgba(31,119,180,1)","width":55},"frame":null},{"colorbar":{"title":"z<br />z","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.221637434921568","rgba(62,74,137,1)"],["0.289818173820992","rgba(56,92,140,1)"],["0.30535072891251","rgba(54,97,141,1)"],["0.325753199630234","rgba(50,102,142,1)"],["0.34319853044906","rgba(49,106,142,1)"],["0.355844604946873","rgba(48,109,142,1)"],["0.370479478549769","rgba(47,113,142,1)"],["0.4060483140538","rgba(43,121,142,1)"],["0.440581835805828","rgba(39,129,142,1)"],["0.462965310142563","rgba(38,135,141,1)"],["0.473470243014988","rgba(38,137,141,1)"],["0.494069002494056","rgba(37,142,140,1)"],["0.506971622517171","rgba(36,146,139,1)"],["0.556534378876834","rgba(31,158,137,1)"],["0.572666323115025","rgba(36,162,135,1)"],["0.583914013877104","rgba(39,164,133,1)"],["0.618538879809166","rgba(46,172,128,1)"],["0.652089602248783","rgba(51,180,123,1)"],["0.665779350743679","rgba(53,183,121,1)"],["0.679838785212977","rgba(62,186,118,1)"],["0.698526190183692","rgba(74,189,113,1)"],["0.734653129574334","rgba(91,196,102,1)"],["0.761109812982927","rgba(103,202,94,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[-0.271587810661127,0.392192372148248,-0.0701496159177563,-1.65549736240213,0.0866980662935922,0.0268015244547493,-0.756350691230064,0.327676500990502,0.686491468460999,-0.508517331496155,-2.18063643038127,-0.437402169683251,-1.1396804012721,1.40621950043755,0.681189339215317,-0.821956605066231,-0.344865158445458,0.930754228148056,0.476203866314539,1.59947574076475,-0.160764864969718,0.373514619677727,-0.485536614556292,-1.15882076635603,0.659528834352383,-1.84545505772402,1.69719354315927,-0.973376250676385,-0.816970711838642,-0.196552239944426,0.884929935545338,-0.838638259776271,-0.139345767024431,1.18417216009946,1.52300523059503,1.99386537237155,-0.710713114626022,0.685701546705991,0.39016302469895,0.403288264313363,0.111830983924876,-0.55227193377019,1.52013377493961,1.3920782583541,1.15592708374185,-0.515644621892054,1.29997912427624,-1.05975544308826,1.56693296940303,-0.754411886931618,0.713857325007896,1.60847672755908,-0.305086079990094,0.82040543937127,-2.0235191356017,-0.663953454898117,0.0709636290426882,0.00848481304508166,0.52773649014865,-3.09854127485718,1.69212974064091,0.0371489716992919,-0.482159005575903,0.3832281734916,-0.370585849338308,-0.676800386846613,0.163843690275304,0.699276086832982,-1.65279427512384,0.461933214514168,-0.342616330160529,0.286262805652797,0.268950869339603,0.0308191241864684,0.597314274265292,0.166259974597976,0.425253553060923,-1.56129616098888,-0.337130911644705,0.000111881197584884,0.33240472250862,-0.218762800819389,0.778611230629806,0.676102779493034,0.675769962140239,-1.69247961538693,-0.0234289903836234,0.702739246326102,0.268816628462489,-0.625291534792762,0.653719661822369,0.387071734324719,-0.728555289709032,0.992954900294477,-1.80663396248957,0.184917728479664,0.33347173251769,-0.504445217750995,-2.05010777766507,-1.63974651833517],"y":[0.6383599893899,2.60837969309348,-1.73410713393371,0.79647688945519,0.835518345136323,-1.01476623925331,0.829105262583481,-0.636531167463544,0.562889208109096,-0.353974231750937,-1.65256070743232,-1.44741075080028,0.19632210085371,1.62691951933712,-0.704777144731743,0.0830398464104174,0.0107759495583198,1.49765943539497,0.307882000654262,0.954150953030532,1.37360413513724,0.32406400572121,0.827632669977233,0.91513433417441,-0.269732300634022,1.28727788445067,-0.131238310055357,-1.26318619435349,0.260718488949208,-0.404475102266581,1.42780906300414,-1.30919343249675,-0.445910091463783,-1.03109100424914,1.60204991005596,-2.25283055851512,-1.29873091698353,0.591167627503003,-0.725385522353922,0.629743094073801,-0.855825008540006,1.03425078418348,0.201010638072139,-0.580619909433653,1.52838193918981,-0.892055850780181,-0.0809428841033086,0.868251034630829,0.298084997522355,1.11113153154468,0.549356599019859,0.307546929847733,3.22099073306569,-1.12789156505879,0.458972393521946,-1.87933792955786,2.49888699881599,-1.19863322568705,0.745557404604009,0.261159691735355,1.91411909412035,1.19230112446245,0.181516004762164,-0.945446008689261,1.11731419970236,-0.381073275503367,-1.82022086845281,1.38837591443655,0.976286314968764,-0.725518297573785,1.26102827239444,-0.906150700670174,-0.216471055803369,-0.265398745344153,0.0489975975595315,0.87408696657187,1.14186713087252,0.605964208037503,0.408946301807866,1.96445376745744,0.326790689872203,-0.31102611624452,0.667251868984243,-1.14446927611478,-0.7221611386795,-0.232599977843826,0.082991082318552,1.84123639603891,-1.26908041337854,-1.77578604811677,-0.657545583429841,0.480205478491412,-0.13270777868407,0.135985694782299,0.934547099054782,0.86833113725649,-1.15242022956437,-0.440514178595506,-0.434033801020963,-1.11855821219401],"z":[-3.73497556827175,-12.2575137211709,8.53023643783302,-7.29337917208022,-4.00419559309443,5.12743424517605,-5.65822769537754,3.83800883929872,-1.44146310362348,0.752836495762377,3.90153067639905,6.36224941463492,-3.26097130681275,-5.3221585958105,4.88626440208935,-2.05911244218455,-0.743610064682514,-5.62678872067872,-0.587002270642231,-1.57180328362317,-7.18955040562566,-0.873290789250598,-5.10923657899875,-6.89331320358411,2.66771917187487,-10.1272995377014,4.05057863659532,4.36917847041466,-2.93753386842332,1.62927103144405,-5.36918544393005,4.8686906429312,1.95085892327005,7.52379934144463,-4.96423908908972,15.2518835373187,5.0722283556656,-1.58443504410303,4.40725366116751,-2.34213894174228,4.50278701054978,-6.27579778845779,2.03521435951852,5.68725606387646,-5.33005552846535,3.4289900101168,3.00467266906903,-6.46076605933066,1.64344095119429,-7.06448143158661,-1.3190683450835,1.6792188058795,-16.7151258253086,7.28026870403647,-6.34190023881314,8.06878273799306,-12.3525077359946,6.01013575452543,-2.67231404272274,-7.50288100839114,-6.18633598931994,-5.88720767891367,-1.87189803496263,5.4936863904295,-6.32774269718844,0.551765603823609,9.42879172281465,-5.5433273985168,-8.18702012509149,4.55145791689726,-6.99037402229326,5.10327911465646,1.62025701769605,1.3886319750937,0.949640560732927,-4.0379148836634,-4.85882854824076,-6.15241336216528,-2.71899333232874,-9.82204507489201,-0.969144004343777,1.11760497958382,-1.77903688366161,7.07455193955997,4.96234561767798,-2.22195934155472,-0.461813392360007,-7.80070348754236,6.88303532381768,7.62834717099834,4.59516724079394,-1.62688392380762,-0.793571685997712,1.30598132667746,-8.28600342025305,-3.97182022932313,6.42904461285721,1.19368045747554,-1.93004655022532,2.3132980242997],"type":"mesh3d","opacity":0.3,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>

---

# Fonctionnement de l'ACP

L'ACP est une transformation de la matrice `\(X\)` ( `\(n\)` observations `\(\times ~ p\)` variables, préalablement normalisées) choisie pour que:

--

- le premier axe soit dans la direction de variation maximale des données;
    
--

- le deuxième axe soit dans la direction de variation maximale qui est orthogonale (perpendiculaire) au premier;
    
--

- le troisième axe soit dans la direction de variation maximale qui est orthogonale aux deux premiers; et ainsi de suite.
    
--
    
Ces axes (composantes principales) sont donc orthogonaux (non-corrélés) et classés en ordre décroissant de variance expliquée.

---

# Fonctionnement de l'ACP

- Mathématiquement, l'ACP requiert le calcul des valeurs propres et vecteurs propres de la matrice des covariances entre paires de variables dans `\(X\)`. Les vecteurs propres indiquent la direction des composantes principales et les valeurs propres indiquent la variance des données sur chaque axe.

--

- L'ACP est basée sur la théorie des distributions normales multivariées, donc fonctionne mieux lorsque les variables s'approchent de la normalité.

--

- Nous verrons au prochain cours des méthodes d'ordination adaptées aux données de présence-absence et d'abondance communes en écologie.

---

# ACP avec R

- `prcomp`: Exécute une ACP à partir d'une matrice de données multivariées.

--

- Le résultat de `prcomp` indique la transformation linéaire effectuée sur les variables originales pour former les composantes principales (`$rotation`), ainsi que les coordonnées transformées de chaque observation (`$x`).

--

- `summary`: Sommaire d'une ACP, qui donne pour chaque composante principale son écart-type, la fraction de la variance totale contenue dans cette composante et la fraction cumulative de la variance pour les composantes jusqu'à celle-ci. 

---

# ACP avec R

- `biplot`: Présente un diagramme de double projection, avec la position des observations et direction des variables originales.

    + Les observations plus rapprochées sont plus similaires selon les composantes affichées.
    + Les variables pointant dans une direction semblable sont positivement corrélées, celles pointant dans des directions opposées sont négativement corrélées.

---

# ACP et régression

- L'ACP peut transformer un grand nombre de prédicteurs corrélés en un plus petit nombre de variables non-corrélées.

--

- Principal inconvénient: les effets sont plus difficiles à interpéter.

--

- Tout de même utile dans les cas où on s'intéresse d'abord à prédire la réponse et que l'effet d'un prédicteur individuel est moins important.

    + Exemple: Prédire la composition de végétation à partir d'images de télédétection hyperspectrale (réflectance pour des centaines de longueurs d'onde).
    
---

# Combien de composantes choisir?

- Variances associées aux composantes principales; leur moyenne est 1 pour des données normalisées.

--

- Critère simple: conserver les composantes avec une variance supérieure à 1.

--

- D'autres critères basés sur des tests statistiques formels, voir Peres-Neto et al. (2005) pour une comparaison.

--

- Dans une analyse exploratoire, le choix du nombre de composantes n'est pas critique. Pour une ACP suivie d'une régression, on peut procéder par sélection de modèles.

---

class: inverse, middle

# Classification hiérarchique ascendante

---

# Classification hiérarchique ascendante 

- La classification hiérarchique ascendante vise à créer des groupes d'observations semblables selon une série de variables. 

--

- Le nom vient du fait qu'on commence avec les observations individuelles, qui sont regroupées progressivement jusqu'à ce qu'on obtienne un seul groupe.

--

- La structure résultante est un arbre ou *dendrogramme* montrant les relations de proximité pour l'ensemble des observations.

---

# Matrice de distance

- L'algorithme de classification hiérarchique requiert une matrice de la distance `\(d_{ij}\)` pour chaque paire d'observations `\(i\)` et `\(j\)`.

$$  
`\begin{bmatrix}
0 \\
d_{21} &amp; 0  \\
d_{31} &amp; d_{32} &amp; 0 \\
... \\
d_{n1} &amp; d_{n2} &amp; ... &amp; d_{n(n-1)} &amp; 0
\end{bmatrix}`
$$

--

- La fonction `dist` dans R calcule la matrice de distance entre les rangées d'une matrice. 

--

- Comme pour l'ACP, les différentes variables doivent être normalisées au préalable.

---

# Matrice de distance

- Pour des variables numériques, la distance la plus couramment utilisée est la *distance euclidienne*:

`$$d_{ij} = \sqrt{\sum_{k = 1}^p (x_{ik} - x_{jk})^2}$$`

--

- En deux dimensions, cela correspond à la distance en ligne droite calculée par le théorème de Pythagore:

`$$d_{ij} = \sqrt{(x_i - x_j)^2 + (y_i - y_j)^2}$$`

---

# Algorithme de classification

- Supposons qu'on ait la matrice de distance suivante entre 4 observations.

$$
`\begin{array}
&amp;&amp; A &amp; B &amp; C \\
B &amp; 11 \\
C &amp; 13 &amp; 6 \\ 
D &amp; 7 &amp; 11 &amp; 9 
\end{array}`
$$ 

--

- L'algorithme regroupe d'abord les deux observations les plus rapprochées, soit B et C (distance de 6). 

--

- Ensuite, il remplace B et C par une observation BC et calcule la distance entre ce groupe et chacune des autres observations existantes.

---

# Algorithme de classification

- Différents critères possibles pour la distance entre un groupe et une observation.

--

- Utilisons une règle ou la distance à partir d'un groupe est la moyenne des distances des éléments de ce groupe.

--

$$
`\begin{array}
&amp;&amp; A &amp; B &amp; C \\
B &amp; 11 \\
C &amp; 13 &amp; 6 \\ 
D &amp; 7 &amp; 11 &amp; 9 
\end{array}`
$$ 

---

# Algorithme de classification

- Différents critères possibles pour la distance entre un groupe et une observation.

- Utilisons une règle ou la distance à partir d'un groupe est la moyenne des distances des éléments de ce groupe.

$$
`\begin{array}
&amp; &amp; A &amp; BC \\
BC &amp; 12 &amp; \\
D &amp; 7 &amp; 10 
\end{array}`
$$ 

---

# Algorithme de classification

- Le nouveau groupe (BC) est traité comme une observation et on répète le processus jusqu'à ce qu'il n'y ait que deux groupes, joints à la dernière étape.

$$
`\begin{array}
&amp; &amp; A &amp; BC \\
BC &amp; 12 &amp; \\
D &amp; 7 &amp; 10 
\end{array}`
$$ 

---

# Algorithme de classification

- Le nouveau groupe (BC) est traité comme une observation et on répète le processus jusqu'à ce qu'il n'y ait que deux groupes, joints à la dernière étape.

$$
`\begin{array}
&amp;  &amp;AD  \\
BC &amp; 11
\end{array}`
$$ 

---

# Critères de regroupement

L'argument `method` indique comment calculer la distance entre groupes A et B:

--

- saut minimum (`method = "single"`): distance minimale entre une observation dans A et une observation dans B.

--

- saut maximum (`method = "complete"`): distance maximale entre une observation dans A et une observation dans B.

--

- lien moyen (`method = "average"`): moyenne des distances sur l'ensemble des paires d'observations dont une est dans A et une dans B.

--

- la critère de Ward (`method = "ward.D2"`): regroupement qui minimise l'augmentation de la variance totale intra-groupe. 

---

# Classification hiérarchique dans R

- `dist`: Calcule une matrice de distance.

- `hclust`: Effectue une classification hiérarchique ascendante à partir d'une matrice de distance, selon une méthode donnée.

- `plot`: Appliquée au résultat de `hclust`, produit un dendrogramme.

- `cutree`: Coupe le dendrogramme à une certaine hauteur *h*, ou pour obtenir un certain nombre de groupes *k*. 

---

# Résumé

- Les analyses multivariées servent à décrire et expliquer la distribution conjointe de plusieurs variables.

--

- Lorsque les variables représentent différentes unités, il est important de les normaliser afin d'obtenir des échelles comparables.

--

- L'ordination vise à produire dans un nombre de dimensions réduit (souvent 2) la représentation la plus fidèle possible de la variation entre les observations multivariées.

---

# Résumé

- L'analyse en composantes principales (ACP) est une méthode d'ordination qui effectue une transformation linéaire (rotation) des variables originales, afin d'obtenir des composantes principales qui sont non-corrélées et classées en ordre décroissant de variance. 

--

- Les coordonnées des observations et les variables originales peut être représentées simultanément dans l'espace des composantes principales (diagramme de double projection).

---

# Résumé

- Les méthodes de regroupement visent à classer les observations multivariées dans un petit nombre de groupes d'observations les plus similaires possibles. 

--

- La classification hiérarchique ascendante effectue un regroupement graduel à partir des observations individuelles et en fonction de différentes règles qui définissent la distance entre groupes. Cette classification produit un dendrogramme.

---

# Références

- Manly, B.F. et Alberto, J.A.N. (2016) *Multivariate statistical methods: a primer*. Chapman and Hall/CRC.

- Legendre, P. et Legendre, L. (2012) *Numerical Ecology*, 3e éd. Elsevier.

- Borcard, D., Gillet, F. et Legendre, P. (2018) *Numerical Ecology with R*, 2e éd. Springer.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
