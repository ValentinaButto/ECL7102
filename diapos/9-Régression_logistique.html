<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>RÃ©gression logistique</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="libs/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="libs/reveal.js-3.3.0.1/css/theme/night.css" id="theme">

<style type="text/css">
.reveal section img {
  background: rgba(255, 255, 255, 0.85);
}
</style>

  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>

    <link rel="stylesheet" href="styles.css"/>

<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">RÃ©gression logistique</h1>
    <h3 class="date"><br/>5 novembre 2018</h3>
</section>

<section id="objectifs" class="slide level2">
<h2>Objectifs</h2>
<ul>
<li class="fragment"><p>ConnaÃ®tre les composantes dâun modÃ¨le linÃ©aire gÃ©nÃ©ralisÃ©.</p></li>
<li class="fragment"><p>Utiliser la rÃ©gression logistique pour modÃ©liser une rÃ©ponse binaire (+/-), une rÃ©ponse binomiale (nombre de + et -) ou des proportions.</p></li>
<li class="fragment"><p>InterprÃ©ter les rÃ©sultats dâune rÃ©gression logistique et visualiser les effets des prÃ©dicteurs.</p></li>
</ul>
</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<p>Les donnÃ©es ne sont pas toujours normalement distribuÃ©es.</p>
<p><img src="../images/paranormal.jpg" /></p>
</section>
<section id="motivation-1" class="slide level2">
<h2>Motivation</h2>
<p>ModÃ¨les avec une rÃ©ponse catÃ©gorique binaire (non/oui, 0/1)</p>
<ul>
<li class="fragment"><p>survie ou mort dâindividus dans un intervalle de temps donnÃ©;</p></li>
<li class="fragment"><p>prÃ©sence ou absence dâune espÃ¨ce sur diffÃ©rents sites;</p></li>
<li class="fragment"><p>dÃ©cision dâun animal de demeurer au mÃªme site ou migrer Ã  un autre site.</p></li>
</ul>
</section>
<section id="motivation-2" class="slide level2">
<h2>Motivation</h2>
<p>Est-ce quâon peut modÃ©liser la relation entre la rÃ©ponse moyenne <span class="math inline">\(\hat{y}\)</span> et des prÃ©dicteurs au moyen dâune rÃ©gression linÃ©aire?</p>
<p><span class="math display">\[ \hat{y} = \beta_0 + \sum_{i = 1}^m \beta_i x_i \]</span></p>
<ul>
<li class="fragment"><p>PrÃ©dictions peuvent Ãªtre &lt;0 ou &gt;1.</p></li>
<li class="fragment"><p>Variance non homogÃ¨ne (<span class="math inline">\(y\)</span> moins variable si <span class="math inline">\(\hat{y}\)</span> prÃ¨s de 0 ou 1).</p></li>
</ul>
</section>
<section><section id="modeles-lineaires-generalises-glm" class="titleslide slide level1"><h1>ModÃ¨les linÃ©aires gÃ©nÃ©ralisÃ©s (GLM)</h1></section><section id="modeles-lineaires-generalises" class="slide level2">
<h2>ModÃ¨les linÃ©aires gÃ©nÃ©ralisÃ©s</h2>
<p>Extensions de la rÃ©gression linÃ©aire</p>
<ul>
<li class="fragment"><p>diffÃ©rentes distributions de la rÃ©ponse (pas seulement normale);</p></li>
<li class="fragment"><p>diffÃ©rentes transformation des prÃ©dictions linÃ©aires.</p></li>
</ul>
</section><section id="composantes-dun-modele-lineaire-generalise" class="slide level2">
<h2>Composantes dâun modÃ¨le linÃ©aire gÃ©nÃ©ralisÃ©</h2>
<ul>
<li class="fragment"><p>PrÃ©dicteur linÃ©aire</p></li>
<li class="fragment"><p>Fonction de lien entre le prÃ©dicteur linÃ©aire et la rÃ©ponse moyenne</p></li>
<li class="fragment"><p>Distribution des rÃ©ponses individuelles</p></li>
</ul>
</section><section id="composantes-dun-modele-lineaire-generalise-1" class="slide level2">
<h2>Composantes dâun modÃ¨le linÃ©aire gÃ©nÃ©ralisÃ©</h2>
<p><strong>Exemple</strong>: RÃ©gression linÃ©aire</p>
<p><span class="math display">\[ \hat{y} = \beta_0 + \sum_{i = 1}^m \beta_i x_i \]</span></p>
<ul>
<li class="fragment"><p>PrÃ©dicteur linÃ©aire: <span class="math inline">\(\eta = \beta_0 + \sum_{i = 1}^m \beta_i x_i\)</span></p></li>
<li class="fragment"><p>Lien entre la rÃ©ponse moyenne et la valeur du prÃ©dicteur: <span class="math inline">\(\hat{y} = \eta\)</span></p></li>
<li class="fragment"><p>Distribution des rÃ©ponses individuelles: <span class="math inline">\(y \sim N(\hat{y}, \sigma)\)</span>.</p></li>
</ul>
</section><section id="types-de-glm-vus-dans-ce-cours" class="slide level2">
<h2>Types de GLM vus dans ce cours</h2>
<ul>
<li class="fragment"><p>RÃ©gression logistique (une ou plusieurs observations dâune rÃ©ponse binaire)</p></li>
<li class="fragment"><p>RÃ©gression de Poisson (donnÃ©es de comptage)</p></li>
</ul>
</section></section>
<section><section id="modele-de-regression-logistique" class="titleslide slide level1"><h1>ModÃ¨le de rÃ©gression logistique</h1></section><section id="modele-de-regression-logistique-1" class="slide level2">
<h2>ModÃ¨le de rÃ©gression logistique</h2>
<p>Dans ce modÃ¨le:</p>
<ul>
<li class="fragment"><p>la rÃ©ponse suit une distribution binomiale (codÃ©e 0/1) et</p></li>
<li class="fragment"><p>la fonction <em>logit</em> permet de relier la probabilitÃ© dâun rÃ©sultat positif (<span class="math inline">\(y = 1\)</span>) Ã  la valeur du prÃ©dicteur linÃ©aire.</p></li>
</ul>
</section><section id="distribution-binomiale" class="slide level2">
<h2>Distribution binomiale</h2>
<ul>
<li>ExpÃ©rience rÃ©pÃ©tÃ©e <span class="math inline">\(n\)</span> fois, probabilitÃ© <span class="math inline">\(p\)</span> dâun succÃ¨s et <span class="math inline">\(1-p\)</span> dâun dâÃ©chec.</li>
</ul>
<ul>
<li>Le nombre de succÃ¨s <span class="math inline">\(y\)</span> suit une distribution binomiale: <span class="math inline">\(y \sim B(n, p)\)</span>.</li>
</ul>
<ul>
<li>Selon cette distribution, la probabilitÃ© dâobtenir <span class="math inline">\(y\)</span> succÃ¨s et <span class="math inline">\(n-y\)</span> Ã©checs correspond Ã :</li>
</ul>
<p><span class="math display">\[ \frac{n!}{y!(n-y)!} p^y (1-p)^{n-y}  = \binom{n}{y} p^y(1-p)^{n-y}\]</span></p>
</section><section id="proprietes-de-la-distribution-binomiale" class="slide level2">
<h2>PropriÃ©tÃ©s de la distribution binomiale</h2>
<ul>
<li class="fragment"><p>Nombre de succÃ¨s (<span class="math inline">\(y\)</span>): moyenne <span class="math inline">\(np\)</span>, variance <span class="math inline">\(np(1-p)\)</span>.</p></li>
<li class="fragment"><p>Proportion de succÃ¨s (<span class="math inline">\(y/n\)</span>): moyenne <span class="math inline">\(p\)</span>, variance <span class="math inline">\(p(1-p)/n\)</span></p></li>
<li class="fragment"><p>Dans les deux cas, la variance est maximale si <span class="math inline">\(p = 0.5\)</span> est tend vers 0 lorsquâon approche <span class="math inline">\(p = 0\)</span> et <span class="math inline">\(p = 1\)</span>.</p></li>
<li class="fragment"><p>Cas particulier <span class="math inline">\(n = 1\)</span>: distribution de Bernoulli. Moyenne de <span class="math inline">\(p\)</span> et variance de <span class="math inline">\(p(1-p)\)</span>.</p></li>
</ul>
</section><section id="exemple" class="slide level2">
<h2>Exemple</h2>
<p>Fonctions dans R: <code>rbinom</code>, <code>dbinom</code>, <code>pbinom</code> et <code>qbinom</code>.</p>
<p>Exemple: ProbabilitÃ© dâobtenir 2 succÃ¨s sur 5 essais, avec <span class="math inline">\(p\)</span> = 0.3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbinom</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="fl">0.3</span>)</code></pre></div>
<pre><code>## [1] 0.3087</code></pre>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-2-1.png" width="384" /></p>
</section><section id="lien-logit" class="slide level2">
<h2>Lien logit</h2>
<p><span class="math display">\[ \eta = \text{logit}(p) = \log \left( \frac{p}{1-p} \right) \]</span></p>
<p>Inverse du logit: fonction logistique</p>
<p><span class="math display">\[ p = \frac{1}{1 + e^{-\eta}} \]</span></p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-3-1.png" width="384" /></p>
</section><section id="proprietes-du-lien-logit" class="slide level2">
<h2>PropriÃ©tÃ©s du lien logit</h2>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(\eta = 0\)</span>, <span class="math inline">\(p = 0.5\)</span>.</p></li>
<li class="fragment"><p>La fonction est symÃ©trique autour de ce point central: <span class="math inline">\(p(-\eta) = 1 - p(\eta)\)</span>.</p></li>
<li class="fragment"><p><span class="math inline">\(p \rightarrow 0\)</span> lorsque <span class="math inline">\(\eta \rightarrow -\infty\)</span> et <span class="math inline">\(p \rightarrow 1\)</span> lorsque <span class="math inline">\(\eta \rightarrow +\infty\)</span>.</p></li>
<li class="fragment"><p>La pente de la courbe est plus prononcÃ©e au centre et plus faible (tendant vers 0) aux extrÃ©mitÃ©s.</p></li>
</ul>
</section><section id="resume-du-modele" class="slide level2">
<h2>RÃ©sumÃ© du modÃ¨le</h2>
<p>Distribution binomiale:</p>
<p><span class="math display">\[ y \sim B(n, p) \]</span></p>
<p>Lien logit:</p>
<p><span class="math display">\[ \text{logit}(p) = \beta_0 + \sum_{i = 1}^m \beta_i x_i \]</span></p>
<p>Ã©quivalent Ã </p>
<p><span class="math display">\[ p = \frac{1}{1 + e^{-(\beta_0 + \sum_{i = 1}^m \beta_i x_i)}} \]</span></p>
</section><section id="maximum-de-vraisemblance" class="slide level2">
<h2>Maximum de vraisemblance</h2>
<ul>
<li class="fragment"><p>Lâestimation des coefficients <span class="math inline">\(\beta\)</span> dâun modÃ¨le linÃ©aire gÃ©nÃ©ralisÃ© nâest pas basÃ©e sur les moindres carrÃ©s, mais plutÃ´t sur le maximum de vraisemblance (<em>maximum likelihood</em>).</p></li>
<li class="fragment"><p>Les valeurs des coefficients <span class="math inline">\(\beta\)</span> choisies maximisent la probabilitÃ© conjointe de lâensemble des observations de <span class="math inline">\(y\)</span>.</p></li>
</ul>
</section><section id="interpretation-des-coefficients" class="slide level2">
<h2>InterprÃ©tation des coefficients</h2>
<p><strong>Exemple</strong>: <span class="math inline">\(\text{logit}(p) = -1 + 0.4x\)</span></p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-4-1.png" width="384" /></p>
</section><section id="interpretation-des-coefficients-1" class="slide level2">
<h2>InterprÃ©tation des coefficients</h2>
<p><strong>Exemple</strong>: <span class="math inline">\(\text{logit}(p) = -1 + 0.4x\)</span></p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-5-1.png" width="384" /></p>
<ul>
<li class="fragment"><span class="math inline">\(\beta_0\)</span>: <span class="math inline">\(\text{logit}(p)\)</span> si <span class="math inline">\(x = 0\)</span>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">invlogit &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">exp</span>(<span class="op">-</span>x))
<span class="kw">invlogit</span>(<span class="op">-</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 0.2689414</code></pre>
</section><section id="interpretation-des-coefficients-2" class="slide level2">
<h2>InterprÃ©tation des coefficients</h2>
<p><strong>Exemple</strong>: <span class="math inline">\(\text{logit}(p) = -1 + 0.4x\)</span></p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-7-1.png" width="384" /></p>
<ul>
<li class="fragment"><span class="math inline">\(p = 0.5\)</span> si <span class="math inline">\(-1 + 0.4x = 0\)</span> (donc <span class="math inline">\(x = 2.5\)</span>)</li>
</ul>
</section><section id="interpretation-des-coefficients-3" class="slide level2">
<h2>InterprÃ©tation des coefficients</h2>
<p><strong>Exemple</strong>: <span class="math inline">\(\text{logit}(p) = -1 + 0.4x\)</span></p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-8-1.png" width="384" /></p>
<ul>
<li class="fragment"><p><span class="math inline">\(\beta_1/4\)</span> est la pente maximale de <span class="math inline">\(p\)</span> vs. <span class="math inline">\(x\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(x\)</span> augmente de 1, <span class="math inline">\(p\)</span> augmente au plus de 0.1.</p></li>
</ul>
</section></section>
<section><section id="regression-logistique-avec-r" class="titleslide slide level1"><h1>RÃ©gression logistique avec R</h1></section><section id="regression-logistique-avec-r-1" class="slide level2">
<h2>RÃ©gression logistique avec R</h2>
<p>Nous verrons des exemples pour trois types de rÃ©ponse:</p>
<ul>
<li class="fragment"><p>une variable binaire codÃ©e par des valeurs logiques (FALSE, TRUE), des valeurs numÃ©riques (0, 1) ou un facteur (1er niveau = 0, autres niveaux = 1);</p></li>
<li class="fragment"><p>une variable binomiale dÃ©crite par deux colonnes (nombre de succÃ¨s, nombre dâÃ©checs);</p></li>
<li class="fragment"><p>une variable indiquant une proportion entre 0 et 1.</p></li>
</ul>
</section><section id="exemple-1-concentrations-darsenic-dans-des-puits-au-bangladesh" class="slide level2">
<h2>Exemple 1: Concentrations dâarsenic dans des puits au Bangladesh</h2>
<ul>
<li class="fragment"><p>Tableau de donnÃ©es <code>Wells</code> du package <strong>carData</strong></p></li>
<li class="fragment"><p>3020 mÃ©nages avec un puits Ã  haute concentration en arsenic</p></li>
<li class="fragment"><p>Quels facteurs dÃ©terminent si un mÃ©nage change de puits?</p></li>
</ul>
</section><section id="exemple-1-concentrations-darsenic-dans-des-puits-au-bangladesh-1" class="slide level2">
<h2>Exemple 1: Concentrations dâarsenic dans des puits au Bangladesh</h2>
<ul>
<li class="fragment"><p>RÃ©ponse: Changer de puits ou non (<code>switch</code>)</p></li>
<li class="fragment"><p>PrÃ©dicteurs: concentration dâarsenic (en mutiples de 100 <span class="math inline">\(\mu g/L\)</span>), distance du puits sÃ»r le plus prÃ¨s (en m).</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(carData)
<span class="kw">str</span>(Wells)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3020 obs. of  5 variables:
##  $ switch     : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 2 1 2 2 2 2 2 2 2 ...
##  $ arsenic    : num  2.36 0.71 2.07 1.15 1.1 3.9 2.97 3.24 3.28 2.52 ...
##  $ distance   : num  16.8 47.3 21 21.5 40.9 ...
##  $ education  : int  0 0 10 12 14 9 4 10 0 0 ...
##  $ association: Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 2 2 2 1 2 2 ...</code></pre>
</section><section id="exploration-des-donnees" class="slide level2">
<h2>Exploration des donnÃ©es</h2>
<p>Distribution des prÃ©dicteurs potentiels lorsque la rÃ©ponse est positive ou nÃ©gative</p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-10-1.png" width="480" /></p>
</section><section id="fonction-glm" class="slide level2">
<h2>Fonction glm</h2>
<p>Semblable Ã  <code>lm</code>, mais il faut aussi spÃ©cifier la distribution de la rÃ©ponse (<code>family</code>) et la fonction de lien.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="cf">switch</span> <span class="op">~</span><span class="st"> </span>arsenic <span class="op">+</span><span class="st"> </span>distance, <span class="dt">data =</span> Wells,
           <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))
<span class="kw">summary</span>(mod)</code></pre></div>
<ul>
<li class="fragment">Par dÃ©faut, la famille binomiale utilise le lien logit.</li>
</ul>
</section><section id="resultat" class="slide level2">
<h2>RÃ©sultat</h2>
<pre><code>## 
## Call:
## glm(formula = switch ~ arsenic + distance, family = binomial(link = &quot;logit&quot;), 
##     data = Wells)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6351  -1.2139   0.7786   1.0702   1.7085  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.002749   0.079448   0.035    0.972    
## arsenic      0.460775   0.041385  11.134   &lt;2e-16 ***
## distance    -0.008966   0.001043  -8.593   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 4118.1  on 3019  degrees of freedom
## Residual deviance: 3930.7  on 3017  degrees of freedom
## AIC: 3936.7
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</section><section id="visualiser-les-predictions-du-modele" class="slide level2">
<h2>Visualiser les prÃ©dictions du modÃ¨le</h2>
<ul>
<li>Lâeffet de chaque prÃ©dicteur est non-linÃ©aire et dÃ©pend des autres prÃ©dicteurs.</li>
</ul>
<ul>
<li>Regardons les prÃ©dictions du modÃ¨le pour plusieurs combinaisons de concentrations dâarsenic et de distance.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wells_nouv &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">arsenic =</span> <span class="kw">seq</span>(<span class="fl">0.5</span>, <span class="dv">5</span>, <span class="fl">0.5</span>), <span class="dt">distance =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>))</code></pre></div>
<ul>
<li><code>expand.grid</code> gÃ©nÃ¨re toutes les combinaisons des valeurs de diffÃ©rentes variables.</li>
</ul>
</section><section id="visualiser-les-predictions-du-modele-1" class="slide level2">
<h2>Visualiser les prÃ©dictions du modÃ¨le</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wells_nouv<span class="op">$</span>prob_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, wells_nouv, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre></div>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-15-1.png" width="576" /></p>
</section><section id="intervalles-de-confiance-sur-la-probabilite-moyenne" class="slide level2">
<h2>Intervalles de confiance sur la probabilitÃ© moyenne</h2>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-16-1.png" width="576" /></p>
</section><section id="intervalles-de-confiance-sur-la-probabilite-moyenne-1" class="slide level2">
<h2>Intervalles de confiance sur la probabilitÃ© moyenne</h2>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-17-1.png" width="288" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prob_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, wells_nouv, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)
wells_nouv<span class="op">$</span>prob_se &lt;-<span class="st"> </span>prob_pred<span class="op">$</span>se.fit

<span class="kw">ggplot</span>(wells_nouv, <span class="kw">aes</span>(<span class="dt">x =</span> arsenic, <span class="dt">y =</span> prob_pred, <span class="dt">color =</span> <span class="kw">as.factor</span>(distance),
                       <span class="dt">fill =</span> <span class="kw">as.factor</span>(distance))) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> prob_pred <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>prob_se, <span class="dt">ymax =</span> prob_pred <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>prob_se),
                <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span>...</code></pre></div>
</section><section id="distributions-des-residus" class="slide level2">
<h2>Distributions des rÃ©sidus</h2>
<p>Les rÃ©sidus individuels ne sont pas trÃ¨s utiles pour une rÃ©ponse binaire.</p>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-19-1.png" width="576" /></p>
</section><section id="graphique-de-residus-groupes" class="slide level2">
<h2>Graphique de rÃ©sidus groupÃ©s</h2>
<ul>
<li>Grouper des observations dont les prÃ©dictions sont rapprochÃ©s et calculer le rÃ©sidu de la proportion moyenne.</li>
</ul>
<ul>
<li>Fonction <code>binnedplot</code> du <strong>arm</strong>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(arm)
<span class="kw">binnedplot</span>(<span class="kw">fitted</span>(mod), <span class="kw">residuals</span>(mod, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>))</code></pre></div>
</section><section id="graphique-de-residus-groupes-1" class="slide level2">
<h2>Graphique de rÃ©sidus groupÃ©s</h2>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-21-1.png" width="576" /></p>
<ul>
<li class="fragment">Indique aussi un intervalle de prÃ©diction Ã  95%.</li>
</ul>
</section><section id="coefficient-de-determination" class="slide level2">
<h2>Coefficient de dÃ©termination</h2>
<ul>
<li>Le <span class="math inline">\(R^2\)</span> basÃ© sur la somme des Ã©carts carrÃ©s nâest pas appropriÃ© pour les GLM.</li>
</ul>
<ul>
<li>La <strong>dÃ©viance</strong> est une mesure dâÃ©cart entre les valeurs attendues et les observations calculÃ©e Ã  partir de la vraisemblance <span class="math inline">\(L\)</span> du modÃ¨le.</li>
</ul>
<p><span class="math display">\[ D = -2 \log L \]</span></p>
<ul>
<li>La dÃ©viance est Ã©gale au premier terme de lâAIC (sans la pÃ©nalitÃ©).</li>
</ul>
<ul>
<li>Comme pour lâAIC, la valeur absolue nâest pas interprÃ©table.</li>
</ul>
</section><section id="pseudo-r2" class="slide level2">
<h2>Pseudo-<span class="math inline">\(R^2\)</span></h2>
<p>Deux dÃ©viances dans le rÃ©sultat sommaire de <code>glm</code></p>
<ul>
<li><code>Residual deviance</code>: basÃ© sur la vraisemblance du modÃ¨le ajustÃ©.</li>
<li><code>Null deviance</code>: basÃ© sur la vraisemblance du modÃ¨le nul (aucun prÃ©dicteur).</li>
</ul>
<p>Ces valeurs sont analogues Ã  la somme des carrÃ©s rÃ©siduels et totaux. On peut donc dÃ©finir un âpseudo-<span class="math inline">\(R^2\)</span>â:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pseudo_R2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mod<span class="op">$</span>deviance<span class="op">/</span>mod<span class="op">$</span>null.deviance
pseudo_R2</code></pre></div>
<pre><code>## [1] 0.04551395</code></pre>
</section><section id="r2-de-tjur" class="slide level2">
<h2><span class="math inline">\(R^2\)</span> de Tjur</h2>
<p>Autre option de <span class="math inline">\(R^2\)</span>, Ã©gale Ã  la diffÃ©rence entre la prÃ©diction moyenne pour le groupe dâobservations avec <span class="math inline">\(y = 1\)</span> et celle du groupe <span class="math inline">\(y = 0\)</span>.</p>
<p><span class="math display">\[ {R^2}_{\text{Tjur}} = \bar{\hat{y}}_{(y=1)} - \bar{\hat{y}}_{(y=0)} \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r2_tjur &lt;-<span class="st"> </span><span class="kw">mean</span>(mod<span class="op">$</span>fitted.values[mod<span class="op">$</span>y <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mod<span class="op">$</span>fitted.values[mod<span class="op">$</span>y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])
r2_tjur</code></pre></div>
<pre><code>## [1] 0.06004311</code></pre>
</section></section>
<section><section id="regression-logistique-binomiale" class="titleslide slide level1"><h1>RÃ©gression logistique binomiale</h1></section><section id="regression-logistique-binomiale-1" class="slide level2">
<h2>RÃ©gression logistique binomiale</h2>
<ul>
<li class="fragment"><p>Plusieurs rÃ©plicats indÃ©pendants dâune rÃ©ponse binaire pour les mÃªmes prÃ©dicteurs.</p></li>
<li class="fragment"><p>Type de donnÃ©es plus frÃ©quent dans un contexte expÃ©rimental.</p></li>
</ul>
</section><section id="exemple-2-mortalite-descargots-en-fonction-de-lenvironnement" class="slide level2">
<h2>Exemple 2: MortalitÃ© dâescargots en fonction de lâenvironnement</h2>
<ul>
<li class="fragment">Tableau de donnÃ©es <code>snails</code> du package <strong>MASS</strong>.</li>
<li class="fragment">PrÃ©dicteurs: espÃ¨ce dâescargot, tempÃ©rature, humiditÃ© relative, temps dâexposition.</li>
<li class="fragment">RÃ©ponse: Nombre dâescargots morts sur un nombre initial de 20 pour chaque combinaison des prÃ©dicteurs.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">str</span>(snails)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    96 obs. of  6 variables:
##  $ Species : Factor w/ 2 levels &quot;A&quot;,&quot;B&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Exposure: int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Rel.Hum : num  60 60 60 65.8 65.8 65.8 70.5 70.5 70.5 75.8 ...
##  $ Temp    : int  10 15 20 10 15 20 10 15 20 10 ...
##  $ Deaths  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ N       : int  20 20 20 20 20 20 20 20 20 20 ...</code></pre>
</section><section id="exemple-2-mortalite-descargots-en-fonction-de-lenvironnement-1" class="slide level2">
<h2>Exemple 2: MortalitÃ© dâescargots en fonction de lâenvironnement</h2>
<p>Dans ce cas, la rÃ©ponse a deux colonnes (groupÃ©es avec <code>cbind</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_snails &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">cbind</span>(Deaths, N <span class="op">-</span><span class="st"> </span>Deaths) <span class="op">~</span><span class="st"> </span>Species <span class="op">+</span><span class="st"> </span>Exposure <span class="op">+</span><span class="st"> </span>Rel.Hum <span class="op">+</span><span class="st"> </span>Temp,
           <span class="dt">data =</span> snails, <span class="dt">family =</span> binomial)
<span class="kw">summary</span>(mod_snails)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(Deaths, N - Deaths) ~ Species + Exposure + 
##     Rel.Hum + Temp, family = binomial, data = snails)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7261  -0.7107  -0.3362   0.4231   1.7510  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.40495    0.97070  -1.447    0.148    
## SpeciesB     1.30864    0.16350   8.004 1.20e-15 ***
## Exposure     1.50339    0.10235  14.689  &lt; 2e-16 ***
## Rel.Hum     -0.10684    0.01388  -7.699 1.37e-14 ***
## Temp         0.09404    0.01927   4.881 1.06e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 539.72  on 95  degrees of freedom
## Residual deviance:  55.07  on 91  degrees of freedom
## AIC: 223.93
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</section><section id="exemple-2-mortalite-descargots-en-fonction-de-lenvironnement-2" class="slide level2">
<h2>Exemple 2: MortalitÃ© dâescargots en fonction de lâenvironnement</h2>
<p><img src="9-RÃ©gression_logistique_files/figure-revealjs/unnamed-chunk-26-1.png" width="576" /></p>
</section><section id="probleme-de-separation-parfaite" class="slide level2">
<h2>ProblÃ¨me de sÃ©paration parfaite</h2>
<p>Essayons dâestimer sÃ©parÃ©ment le taux de mortalitÃ© pour chaque semaine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_snails2 &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">cbind</span>(Deaths, N <span class="op">-</span><span class="st"> </span>Deaths) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(Exposure), <span class="dt">data =</span> snails,
                   <span class="dt">family =</span> binomial)
<span class="kw">summary</span>(mod_snails2)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(Deaths, N - Deaths) ~ as.factor(Exposure), 
##     family = binomial, data = snails)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9350  -1.0881  -0.0002   0.5037   4.1261  
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)            -20.75     888.02  -0.023    0.981
## as.factor(Exposure)2    17.25     888.02   0.019    0.985
## as.factor(Exposure)3    19.33     888.02   0.022    0.983
## as.factor(Exposure)4    20.13     888.02   0.023    0.982
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 539.72  on 95  degrees of freedom
## Residual deviance: 182.38  on 92  degrees of freedom
## AIC: 349.24
## 
## Number of Fisher Scoring iterations: 17</code></pre>
</section><section id="probleme-de-separation-parfaite-1" class="slide level2">
<h2>ProblÃ¨me de sÃ©paration parfaite</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">group_by</span>(snails, Exposure) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="kw">mean</span>(Deaths))</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Exposure `mean(Deaths)`
##      &lt;int&gt;          &lt;dbl&gt;
## 1        1          0    
## 2        2          0.583
## 3        3          3.88 
## 4        4          7</code></pre>
<ul>
<li class="fragment"><p>LâordonnÃ©e Ã  lâorigine <code>(Intercept)</code> correspond Ã  logit(<span class="math inline">\(p\)</span>) pour <code>Exposure</code> = 1, mais il nây a aucun escargot mort pour ce niveau.</p></li>
<li class="fragment"><p>Fonction logit nâatteint jamais <span class="math inline">\(p = 0\)</span>. Taux de mortalitÃ© trop petit pour Ãªtre estimÃ© (logit trÃ¨s nÃ©gatif).</p></li>
</ul>
</section><section id="probleme-de-separation-parfaite-2" class="slide level2">
<h2>ProblÃ¨me de sÃ©paration parfaite</h2>
<ul>
<li class="fragment"><p>Le coefficient dâune variable qui sÃ©pare parfaitement les rÃ©ponses <span class="math inline">\(y = 1\)</span> et <span class="math inline">\(y = 0\)</span> est mal dÃ©fini, par exemple:</p>
<ul>
<li class="fragment">une catÃ©gorie oÃ¹ toutes les rÃ©ponses sont 0 ou 1;</li>
<li class="fragment">une variable numÃ©rique <span class="math inline">\(x\)</span> avec un seuil <span class="math inline">\(a\)</span> oÃ¹ la rÃ©ponse est toujours 0 si <span class="math inline">\(x &lt; a\)</span> et 1 si <span class="math inline">\(x &gt; a\)</span>.</li>
</ul></li>
<li class="fragment"><p>Il existe des mÃ©thodes de rÃ©duction de biais (ex.: package <strong>brglm</strong>) qui aident dans ce cas, en pÃ©nalisant les coefficients trop Ã©levÃ©s.</p></li>
</ul>
</section></section>
<section><section id="regression-logistique-pour-des-proportions" class="titleslide slide level1"><h1>RÃ©gression logistique pour des proportions</h1></section><section id="regression-logistique-pour-des-proportions-1" class="slide level2">
<h2>RÃ©gression logistique pour des proportions</h2>
<ul>
<li class="fragment"><p>Pour une rÃ©ponse basÃ©e sur un nombre dâindividus (ex.: escargots morts ou vivants), la distribution binomiale sâapplique directement.</p></li>
<li class="fragment"><p>Parfois, la rÃ©ponse existe seulement sous forme de proportion, par exemple:</p>
<ul>
<li class="fragment">proportion dâun quadrat recouvert par une mousse;</li>
<li class="fragment">fraction dâun peuplement brÃ»lÃ©e par un feu.</li>
</ul></li>
</ul>
</section><section id="regression-logistique-pour-des-proportions-2" class="slide level2">
<h2>RÃ©gression logistique pour des proportions</h2>
<ul>
<li class="fragment"><p>Le lien logit fonctionne pour transformer un prÃ©dicteur linÃ©aire en une proportion entre 0 et 1.</p></li>
<li class="fragment"><p>Toutefois, la variance de cette proportion nâest pas connue si elle ne provient pas dâun processus binomial.</p></li>
<li class="fragment"><p>Famille <em>quasibinomiale</em>:</p>
<ul>
<li class="fragment">pas une vraie distribution</li>
<li class="fragment">estimation des coefficients suit la mÃªme formule que la binomiale</li>
<li class="fragment">on estime sÃ©parÃ©ment un paramÃ¨tre de dispersion <span class="math inline">\(\phi\)</span>, pour que la variance des proportions soit Ã©gale Ã  <span class="math inline">\(\phi p (1-p)\)</span>.</li>
</ul></li>
</ul>
</section><section id="regression-logistique-pour-des-proportions-3" class="slide level2">
<h2>RÃ©gression logistique pour des proportions</h2>
<p>Supposons quâon connaÃ®t seulement la proportion dâescargots morts, mais pas le nombre dâindividus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">snails &lt;-<span class="st"> </span><span class="kw">mutate</span>(snails, <span class="dt">prop =</span> Deaths <span class="op">/</span><span class="st"> </span>N)
mod_prop &lt;-<span class="st"> </span><span class="kw">glm</span>(prop <span class="op">~</span><span class="st"> </span>Species <span class="op">+</span><span class="st"> </span>Exposure <span class="op">+</span><span class="st"> </span>Rel.Hum <span class="op">+</span><span class="st"> </span>Temp, 
                <span class="dt">data =</span> snails, <span class="dt">family =</span> quasibinomial)
<span class="kw">summary</span>(mod_prop)</code></pre></div>
</section><section id="regression-logistique-pour-des-proportions-4" class="slide level2">
<h2>RÃ©gression logistique pour des proportions</h2>
<ul>
<li>MÃªmes coefficients que la rÃ©gression prÃ©cÃ©dente, mais les erreurs-types ont un peu changÃ©.</li>
</ul>
<pre><code>## 
## Call:
## glm(formula = prop ~ Species + Exposure + Rel.Hum + Temp, family = quasibinomial, 
##     data = snails)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.38597  -0.15892  -0.07517   0.09461   0.39153  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.404947   0.689052  -2.039   0.0444 *  
## SpeciesB     1.308638   0.116058  11.276  &lt; 2e-16 ***
## Exposure     1.503389   0.072652  20.693  &lt; 2e-16 ***
## Rel.Hum     -0.106843   0.009851 -10.846  &lt; 2e-16 ***
## Temp         0.094041   0.013677   6.876 7.55e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.02519503)
## 
##     Null deviance: 26.9860  on 95  degrees of freedom
## Residual deviance:  2.7535  on 91  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 6</code></pre>
</section><section id="regression-logistique-pour-des-proportions-5" class="slide level2">
<h2>RÃ©gression logistique pour des proportions</h2>
<ul>
<li class="fragment"><p>Nous parlerons davantage du paramÃ¨tre de dispersion au prochain cours.</p></li>
<li class="fragment"><p>Une autre option pour la modÃ©lisation de proportions est la rÃ©gression beta (package <strong>betareg</strong>).</p></li>
</ul>
</section><section id="resume" class="slide level2">
<h2>RÃ©sumÃ©</h2>
<ul>
<li class="fragment"><p>Un modÃ¨le linÃ©aire gÃ©nÃ©ralisÃ© est composÃ© dâun prÃ©dicteur linÃ©aire (combinaison linÃ©aire des variables explicatives), dâune fonction de lien pour la rÃ©ponse moyenne, et dâune distribution statistique de la rÃ©ponse en fonction de sa moyenne.</p></li>
<li class="fragment"><p>La rÃ©gression logistique sert Ã  modÃ©liser des rÃ©ponses binaires ou des proportions. Elle utilise un lien logit et une distribution binomiale de la rÃ©ponse.</p></li>
<li class="fragment"><p>La fonction logit transforme une probabilitÃ© entre 0 et 1 en un nombre rÃ©el entre -<span class="math inline">\(\infty\)</span> et +<span class="math inline">\(\infty\)</span>. Un logit nÃ©gatif correspond Ã  une probabilitÃ© en-dessous de 0.5, un logit positif correspond Ã  une probabilitÃ© au-dessus de 0.5.</p></li>
</ul>
</section><section id="resume-1" class="slide level2">
<h2>RÃ©sumÃ©</h2>
<ul>
<li class="fragment"><p>Dans une rÃ©gression logistique, lâeffet dâun prÃ©dicteur sur la rÃ©ponse est non-linÃ©aire et dÃ©pend de la valeur des autres prÃ©dicteurs. Il est donc utile de visualiser les prÃ©dictions du modÃ¨le pour diffÃ©rentes combinaisons des variables.</p></li>
<li class="fragment"><p>Pour une rÃ©ponse binaire (0 ou 1), les rÃ©sidus individuels donnent peu dâinformation, mais on peut vÃ©rifier lâajustement du modÃ¨le Ã  partir des moyennes de groupes de rÃ©sidus (<em>binned residuals</em>).</p></li>
</ul>
</section></section>
    </div>
  </div>

  <script src="libs/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="libs/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Transition style
        transition: 'none', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom



        // Optional reveal.js plugins
        dependencies: [
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
